<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title th:text="${movie.name}">Chi tiết phim</title>

    <link rel="shortcut icon" href="/web-assets/image/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/web-assets/image/favicon.ico" type="image/x-icon">

    <!--Css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
          integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
          crossorigin="anonymous" referrerpolicy="no-referrer">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"
          integrity="sha512-vKMx8UnXk60zUwyUnUPM3HbQo8QfmNx7+ltw8Pm5zLusl1XIfwcxo8DbWCqMGKaWeNxWA8yrx5v3SaVpMvR3CA=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link rel="stylesheet" href="/web-assets/css/style.css">
</head>
<body>
<header class="bg-dark header">
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="/">
                <img src="/web-assets/image/logo.png" alt="logo" class="logo">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#main-menu" aria-controls="main-menu" aria-expanded="false"
                    aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-between align-items-center" id="main-menu">
                <div class="navbar-nav">
                    <a class="nav-link text-white" href="/">Trang chủ</a>
                    <a class="nav-link text-white" href="/phim-bo">Phim bộ</a>
                    <a class="nav-link text-white" href="/phim-chieu-rap">Phim chiếu rạp</a>
                    <a class="nav-link text-white" href="/phim-le">Phim lẻ</a>
                    <a class="nav-link text-white" href="/tin-tuc">Tin tức</a>
                </div>
                <div>
                    <div>
                        <a class="text-white" href="/dang-nhap">Đăng nhập</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
</header>

<section class="py-4">
    <div class="container">
        <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a class="text-primary" href="/">Trang chủ</a></li>
                <li class="breadcrumb-item">
                    <a th:switch="${movie.type.toString()}">
                        <a class="text-primary" th:case="PHIM_LE" href="/phim-le">Phim lẻ</a>
                        <a class="text-primary" th:case="PHIM_BO" href="/phim-bo">Phim bộ</a>
                        <a class="text-primary" th:case="PHIM_CHIEU_RAP" href="/phim-chieu-rap">Phim chiếu rạp</a>
                        <a class="text-primary" th:case="*" href="#">Không xác định</a> <!-- Trường hợp mặc định -->
                    </a>
                </li>
                <li class="breadcrumb-item active" aria-current="page" th:text="${movie.name}">Đầu Gấu Đụng Đầu Đất
                </li>
            </ol>
        </nav>
        <div class="row mt-4">
            <div class="col-3">
                <img id="movie-poster" class="rounded w-100"
                     th:src="${movie.poster}" th:alt="${movie.name}">
            </div>
            <div class="col-9">
                <h4 class="mb-3" th:text="${movie.name}">Đầu Gấu Đụng Đầu Đất</h4>
                <div class="p-3 bg-body-tertiary">
                    <div class="row">
                        <div class="col-2">
                            <p>Thể loại</p>
                        </div>
                        <div class="col-10">
                            <p>
                                Cổ Trang, Thần Thoại, Hài Hước
                            </p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2">
                            <p>Năm sản xuất</p>
                        </div>
                        <div class="col-10">
                            <p th:text="${movie.releaseYear}">2021</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2">
                            <p>Đạo diễn</p>
                        </div>
                        <div class="col-10">
                            <p>
                                Trần Gia Bội, Lý Tài
                            </p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2">
                            <p>Diễn viên</p>
                        </div>
                        <div class="col-10">
                            <p>
                                Triệu Lộ Tư, Hạ Khai Lãng, Giai Nại Na, Dĩnh Nhi, Tào Phỉ Nhiên, Lý Quân Nhuệ,
                                Vương An Vũ
                            </p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2">
                            <p>Nội dung phim</p>
                        </div>
                        <div class="col-10">
                            <p>
                                <th:block th:text="${movie.description}"></th:block>
                                <a class="text-primary" href="">Xem
                                    thêm</a></p>
                        </div>
                    </div>
                </div>

                <th:block th:if="${movie.type.toString() == 'PHIM_BO' && episodes.size() > 0}">
                    <a class="d-inline-block btn btn-danger px-5 py-2 mt-3 rounded"
                       th:href="@{/xem-phim/{id}/{slug} (id=${movie.id}, slug=${movie.slug}, tap=${episodes.get(0).displayOrder})}">
                        <span><i class="fa-solid fa-play"></i></span>
                        Xem phim</a>
                </th:block>

                <th:block
                        th:if="${(movie.type.toString() == 'PHIM_LE' || movie.type.toString() == 'PHIM_CHIEU_RAP') && episodes.size() > 0}">
                    <a class="d-inline-block btn btn-danger px-5 py-2 mt-3 rounded"
                       th:href="@{/xem-phim/{id}/{slug} (id=${movie.id}, slug=${movie.slug}, tap='full')}">
                        <span><i class="fa-solid fa-play"></i></span>
                        Xem phim</a>
                </th:block>

            </div>
        </div>

        <div class="mt-4" th:if="${movie.type.toString() == 'PHIM_BO' && episodes.size() > 0}">
            <h3 class="mb-3">Tập phim</h3>
            <a class="btn btn-dark me-2"
               th:each="episode : ${episodes}"
               th:text="${episode.name}"
               th:href="@{/xem-phim/{id}/{slug} (id=${movie.id}, slug=${movie.slug}, tap=${episode.displayOrder})}">
                >Tập 1</a>
        </div>
    </div>
</section>

<section class="py-4 bg-body-tertiary">
    <div class="container">
        <h3 class="mb-3">Phim đề xuất</h3>
        <div class="row">
            <div class="col-2" th:each="movie : ${relatedMovies}">
                <div class="movie-item">
                    <a th:href="@{/phim/{id}/{slug} (id=${movie.id}, slug=${movie.slug})}"
                       class="movie-media">
                        <div class="movie-poster rounded overflow-hidden">
                            <img class="w-100 h-100"
                                 th:src="${movie.poster}" th:alt="${movie.name}">
                        </div>
                        <p class="mt-2" th:text="${movie.name}">Cô Đi Mà Lấy Chồng Tôi</p>
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="py-4">
    <div class="container">
        <div>
            <div class="d-flex justify-content-between align-items-center">
                <h3 class="mb-3">Bình luận</h3>
                <button class="btn btn-primary">
                    Viết đánh giá
                </button>
            </div>
            <p>Vui lòng <a href="/dang-nhap" class="text-primary text-decoration-underline">đăng
                nhập</a> để viết bình luận</p>
            <div class="review-list">
                <div class="rating-item d-flex align-items-center mb-3 pb-3" th:each="review: ${reviews}">
                    <div class="rating-avatar">
                        <img th:src="${review.user.avatar}" th:alt="${review.user.name}">
                    </div>
                    <div class="rating-info ms-3">
                        <div class="d-flex align-items-center">
                            <p class="rating-name mb-0">
                                <strong th:text="${review.user.name}">Bùi Hiên</strong>
                            </p>
                            <p class="rating-time mb-0 ms-2" th:text="${#temporals.format(review.createdAt, 'dd/MM/yyyy')}">09/01/2024</p>
                        </div>
                        <div class="rating-star">
                            <p class="mb-0 fw-bold">
                                <span class="rating-icon"><i class="fa fa-star"></i></span>
                                <span><th:block th:text="${review.rating}"></th:block>/10 Tuyệt vời</span>
                            </p>
                        </div>
                        <p class="rating-content mt-1 mb-0 text-muted" th:text="${review.content}">Phim xem ổn. Điểm nhấn chính là sự hài hước và
                            tiết
                            tấu. Kết phim chưa thực sự hài lòng. 1 số nhân vật hoành tráng
                            ở đầu và giữa phim, thì cuối phim mờ nhạt. Diễn biến phim hoặc
                            chưa dành đủ thời gian, hoặc chưa nhấn mạnh đủ để dẫn đến các
                            kết quả ở cuối phim.</p>

                    </div>
                    <div>
                        <button>Sua</button>
                        <button>Xoa</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-review">
    Viết đánh giá
</button>

<!-- Modal -->
<div class="modal fade" id="modal-review" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
     aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="staticBackdropLabel">Tạo đánh giá</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="d-flex flex-column justify-content-center align-items-center">
                    <div class="rating">
                       <span class="star" data-rating="1">
                          <i class="fa-solid fa-star"></i>
                       </span>
                        <span class="star" data-rating="2">
                          <i class="fa-solid fa-star"></i>
                       </span>
                        <span class="star" data-rating="3">
                          <i class="fa-solid fa-star"></i>
                       </span>
                        <span class="star" data-rating="4">
                          <i class="fa-solid fa-star"></i>
                       </span>
                        <span class="star" data-rating="5">
                          <i class="fa-solid fa-star"></i>
                       </span>
                        <span class="star" data-rating="6">
                          <i class="fa-solid fa-star"></i>
                       </span>
                        <span class="star" data-rating="7">
                          <i class="fa-solid fa-star"></i>
                       </span>
                        <span class="star" data-rating="8">
                          <i class="fa-solid fa-star"></i>
                       </span>
                        <span class="star" data-rating="9">
                          <i class="fa-solid fa-star"></i>
                       </span>
                        <span class="star" data-rating="10">
                          <i class="fa-solid fa-star"></i>
                       </span>
                    </div>
                    <div id="rating-value"></div>
                </div>
                <form id="form-review">
                    <div class="mb-3">
                        <label for="review-content" class="form-label">Nội dung đánh giá</label>
                        <textarea class="form-control" id="review-content" rows="3"></textarea>
                    </div>
                    <div class="mb-3">
                        <button type="submit" class="btn btn-primary" id="btn-create-review">Tạo đánh giá</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<footer class="bg-dark py-4 text-white">
    <div class="container">
        <div class="row">
            <div class="col-4">
                <a href="#">
                    <img src="/web-assets/image/logo.png" alt="logo" class="logo">
                </a>
                <p class="mt-2">Motchill - Xem phim Online Vietsub chất lượng cao miễn phí, nhiều thể loại phim
                    phong phú, đặc sắc, giao diện trực quan, thuận tiện, tốc độ tải nhanh, thường xuyên cập nhật các
                    bộ phim mới.</p>
            </div>
            <div class="col-2">
                <h5 class="text-uppercase mb-3">Danh mục</h5>
                <p><a class="text-white" href="#">Tin tức</a></p>
                <p><a class="text-white" href="#">Phim chiếu rạp</a></p>
                <p><a class="text-white" href="#">Phim bộ</a></p>
                <p><a class="text-white" href="#">Phim lẻ</a></p>
                <p><a class="text-white" href="#">TV Show</a></p>
            </div>
            <div class="col-2">
                <h5 class="text-uppercase mb-3">Thể loại</h5>
                <p><a class="text-white" href="">Phim cổ trang</a></p>
                <p><a class="text-white" href="">Phim đam mỹ</a></p>
                <p><a class="text-white" href="">Phim bách hợp</a></p>
                <p><a class="text-white" href="">Phim viễn tưởng</a></p>
                <p><a class="text-white" href="">Phim hoạt hình</a></p>
            </div>
            <div class="col-2">
                <h5 class="text-uppercase mb-3">Điều khoản</h5>
                <p><a class="text-white" href="#">DMCA</a></p>
                <p><a class="text-white" href="#">Liên hệ</a></p>
                <p><a class="text-white" href="#">Privacy</a></p>
                <p><a class="text-white" href="#">Terms of Service</a></p>
            </div>

            <div class="col-2">
                <h5 class="text-uppercase mb-3">SOCIAL</h5>
                <div class="d-flex">
                    <p class="fs-4 me-3">
                        <a class="text-white" href="#"><span><i class="fa-brands fa-facebook"></i></span></a>
                    </p>
                    <p class="fs-4 me-3">
                        <a class="text-white" href="#"><span><i class="fa-brands fa-twitter"></i></span></a>
                    </p>
                    <p class="fs-4 me-2">
                        <a class="text-white" href="#"><span><i class="fa-brands fa-youtube"></i></span></a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
<script src="/web-assets/js/common.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

<script th:inline="javascript">
    const movie = [[${movie}]];
    const reviews = [[${reviews}]];
    console.log(movie)
    console.log(reviews);
</script>
<script src="/web-assets/js/movie-review.js"></script>
</body>
</html>